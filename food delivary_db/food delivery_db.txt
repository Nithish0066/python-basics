USE food1;

CREATE TABLE Customer (
    customer_id INT PRIMARY KEY AUTO_INCREMENT,
    customer_name VARCHAR(100),
    phone VARCHAR(15),
    address VARCHAR(200)
);
 
CREATE TABLE Restaurant (
    restaurant_id INT PRIMARY KEY AUTO_INCREMENT,
    restaurant_name VARCHAR(100),
    location VARCHAR(150)
);

CREATE TABLE Food_Item (
    food_id INT PRIMARY KEY AUTO_INCREMENT,
    food_name VARCHAR(100),
    price DECIMAL(10,2),
    restaurant_id INT,
    FOREIGN KEY (restaurant_id) REFERENCES Restaurant(restaurant_id)
);

CREATE TABLE Delivery_Person (
    delivery_id INT PRIMARY KEY AUTO_INCREMENT,
    delivery_name VARCHAR(100),
    phone VARCHAR(15)
);
CREATE TABLE `Order` (
    order_id INT PRIMARY KEY AUTO_INCREMENT,
    order_date DATE,
    customer_id INT,
    delivery_id INT,
    FOREIGN KEY (customer_id) REFERENCES Customer(customer_id),
    FOREIGN KEY (delivery_id) REFERENCES Delivery_Person(delivery_id)
);
CREATE TABLE Order_Item (
    order_id INT,
    food_id INT,
    quantity INT,
    PRIMARY KEY (order_id, food_id),
    FOREIGN KEY (order_id) REFERENCES `Order`(order_id),
    FOREIGN KEY (food_id) REFERENCES Food_Item(food_id)
);

SELECT * 
FROM `Order`
WHERE customer_id = 1;

SELECT F.food_name, OI.quantity
FROM Order_Item OI
JOIN Food_Item F ON OI.food_id = F.food_id
WHERE OI.order_id = 1;

SELECT R.restaurant_name, COUNT(DISTINCT O.order_id) AS total_orders
FROM Restaurant R
JOIN Food_Item F ON R.restaurant_id = F.restaurant_id
JOIN Order_Item OI ON F.food_id = OI.food_id
JOIN `Order` O ON OI.order_id = O.order_id
GROUP BY R.restaurant_name;

SELECT D.delivery_name, COUNT(O.order_id) AS total_deliveries
FROM Delivery_Person D
JOIN `Order` O ON D.delivery_id = O.delivery_id
GROUP BY D.delivery_name;